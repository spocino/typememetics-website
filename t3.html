<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Old Timey Typewriter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Creepster&family=Oswald:wght@400&family=Special+Elite&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --paper-color: #f1e9d2;
      --ink-color: #3a3a3a;
      --background-color: #2c2c2c;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Special Elite', monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: var(--background-color);
      color: var(--ink-color);
      padding: 1rem;
      overflow: hidden;
    }

    .paper {
      aspect-ratio: 8.5 / 11;
      height: 95vh;
      max-width: 95vw;
      container-type: inline-size;
      container-name: paper;
      background-color: var(--paper-color);
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
      position: relative;
      display: flex;
      flex-direction: column;
      padding: 5cqw 6cqw;
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }

    .paper::before,
    .paper::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    @media (hover: hover) and (pointer: fine) {
      .paper:not(.jumpscare-zoom) {
        cursor: zoom-in;
      }

      .paper.zoomed {
        transform: scale(1.2);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
        z-index: 10;
        cursor: zoom-out;
      }
    }

    .letterhead,
    .page-footer,
    #text-container {
      position: relative;
      z-index: 2;
    }

    .letterhead,
    .page-footer {
      font-family: 'Oswald', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #5a5245;
      text-shadow: 0px 0px 1px rgba(0, 0, 0, 0.2);
    }

    .letterhead {
      display: flex;
      align-items: center;
      gap: 2.5cqw;
      padding-bottom: 2.5cqw;
      margin-bottom: 3cqw;
      border-bottom: 1px solid rgba(0, 0, 0, 0.3);
    }

    .logo {
      width: 10cqw;
      height: 10cqw;
      flex-shrink: 0;
      filter: grayscale(1) sepia(0.4) opacity(0.7) contrast(1.2);
      mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      mask-size: cover;
    }

    .institution-details {
      flex-grow: 1;
      text-align: right;
    }

    .institution-details h1 {
      margin: 0;
      font-size: 2.2cqw;
      font-weight: 400;
      line-height: 1.2;
    }

    .institution-details p {
      margin: 1cqw 0 0 0;
      font-size: 1.6cqw;
      line-height: 1.4;
      font-style: normal;
    }

    #text-container {
      white-space: pre-wrap;
      word-wrap: break-word;
      font-size: 2.1cqw;
      line-height: 2;
      flex-grow: 1;
    }

    .char {
      display: inline-block;
    }

    .hit-light {
      opacity: 0.7;
    }

    .hit-medium {
      opacity: 0.85;
    }

    .hit-hard {
      opacity: 1;
      font-weight: 500;
    }

    .align-up {
      transform: translateY(-0.2cqw);
    }

    .align-down {
      transform: translateY(0.1cqw);
    }

    .page-footer {
      margin-top: 4cqw;
      padding-top: 2.5cqw;
      border-top: 1px solid rgba(0, 0, 0, 0.3);
      text-align: center;
      font-size: 1.5cqw;
    }

    .page-footer p {
      margin: 0;
    }

    .eye {
      position: absolute;
      width: 3.5cqw;
      height: 2cqw;
      z-index: 3;
      overflow: hidden;
      border-radius: 50%;
    }

    .eye .sclera {
      width: 100%;
      height: 100%;
      background-color: #faf6e9;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: inset 0 0 2px 1px rgba(0, 0, 0, 0.2);
    }

    .eye .iris {
      width: 60%;
      height: 60%;
      background: #a11a1a;
      border-radius: 50%;
      box-shadow: 0 0 3px 1px #ff2a2a, 0 0 5px 2px #a11a1a;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .eye .pupil {
      width: 40%;
      height: 40%;
      background: #000;
      border-radius: 50%;
    }

    .eye .eyelid {
      position: absolute;
      left: 0;
      width: 100%;
      height: 50%;
      background-color: var(--paper-color);
    }

    .eye .eyelid.top {
      top: 0;
      animation: open-lid-top 4s ease-in-out forwards;
      box-shadow: inset 0 -1px 1px -1px rgba(0, 0, 0, 0.4);
    }

    .eye .eyelid.bottom {
      bottom: 0;
      animation: open-lid-bottom 4s ease-in-out forwards;
      box-shadow: inset 0 1px 1px -1px rgba(0, 0, 0, 0.4);
    }

    @keyframes open-lid-top {

      0%,
      100% {
        transform: translateY(0%);
      }

      20%,
      80% {
        transform: translateY(-100%);
      }
    }

    @keyframes open-lid-bottom {

      0%,
      100% {
        transform: translateY(0%);
      }

      20%,
      80% {
        transform: translateY(100%);
      }
    }

    #jumpscare-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: black;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 202;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }

    #jumpscare-overlay.visible {
      opacity: 1;
    }

    #jumpscare-text {
      color: #a11a1a;
      font-family: 'Creepster', cursive;
      font-size: 10vw;
      text-shadow: 0 0 15px #ff2a2a, 0 0 25px #ff0000;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.1s, transform 0.3s ease-in-out;
    }

    #jumpscare-text.visible {
      opacity: 1;
      transform: scale(1);
    }

    #jumpscare-text span {
      display: inline-block;
      transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }

    .paper.jumpscare-zoom {
      transition: transform 0.5s cubic-bezier(0.6, 0, 0.7, 1);
      transform: scale(20);
      z-index: 201;
    }

    #trigger-button {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-family: 'Oswald', sans-serif;
      background-color: #a11a1a;
      color: var(--paper-color);
      border: 1px solid #ff2a2a;
      cursor: pointer;
      z-index: 101;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 0 10px #ff2a2a;
    }
  </style>
</head>

<body>

  <div class="paper">
    <header class="letterhead">
      <img src="images/itsmr-logo.png" alt="Institution Seal" class="logo">
      <div class="institution-details">
        <h1>The Institute for Type Safe Memetic Research</h1>
        <p>Truth in Types, Safety in Thought</p>
      </div>
    </header>
    <main id="text-container"></main>
    <footer class="page-footer">
      <p>DOCUMENT #TSMR-734 // CLASSIFIED // EYES ONLY</p>
    </footer>
  </div>

  <div id="jumpscare-overlay">
    <div id="jumpscare-text"></div>
  </div>

  <button id="trigger-button">DO NOT PRESS</button>

  <script>
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function triggerJumpScare() {
      const paper = document.querySelector('.paper');
      const overlay = document.getElementById('jumpscare-overlay');
      const textContainer = document.getElementById('jumpscare-text');
      const letters = textContainer.querySelectorAll('span');

      if (paper.classList.contains('jumpscare-zoom')) return;

      paper.classList.add('jumpscare-zoom');
      overlay.classList.add('visible');

      await sleep(500);

      textContainer.classList.add('visible');
      letters.forEach(letter => {
        const rot = (Math.random() - 0.5) * 20;
        const y = (Math.random() - 0.5) * 15;
        letter.style.transform = `rotate(${rot}deg) translateY(${y}px)`;
      });

      await sleep(1500);

      textContainer.classList.remove('visible');
      letters.forEach(letter => {
        letter.style.transform = 'none';
      });
      await sleep(100);

      paper.classList.remove('jumpscare-zoom');
      overlay.classList.remove('visible');
    }

    function triggerEyeAnomaly() {
      const container = document.querySelector('.paper');
      if (!container) return;
      for (let i = 0; i < 50; i++) {
        const eye = document.createElement('div');
        eye.className = 'eye';
        const sclera = document.createElement('div');
        sclera.className = 'sclera';
        const iris = document.createElement('div');
        iris.className = 'iris';
        const pupil = document.createElement('div');
        pupil.className = 'pupil';
        const topLid = document.createElement('div');
        topLid.className = 'eyelid top';
        const bottomLid = document.createElement('div');
        bottomLid.className = 'eyelid bottom';
        iris.appendChild(pupil);
        sclera.appendChild(iris);
        eye.appendChild(sclera);
        eye.appendChild(topLid);
        eye.appendChild(bottomLid);
        eye.style.left = `${Math.random() * 95}%`;
        eye.style.top = `${Math.random() * 95}%`;
        const randomDelay = `${Math.random() * 2}s`;
        topLid.style.animationDelay = randomDelay;
        bottomLid.style.animationDelay = randomDelay;
        topLid.addEventListener('animationend', () => {eye.remove();});
        container.appendChild(eye);
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      const jumpScareContainer = document.getElementById('jumpscare-text');
      const jumpScareMessage = "I AM WATCHING";
      for (const char of jumpScareMessage) {
        const span = document.createElement('span');
        span.textContent = char;
        if (char === ' ') {
          span.style.width = '0.5em';
        }
        jumpScareContainer.appendChild(span);
      }

      function createPRNG(seed) {
        let currentSeed = seed;
        return function () {
          currentSeed = (1664525 * currentSeed + 1013904223) % 2 ** 32;
          return currentSeed / 2 ** 32;
        };
      }

      const seed = 12345;
      const random = createPRNG(seed);
      const paperElement = document.querySelector('.paper');

      const backgroundGradients = [];
      if (random() < 0.4) {
        const numSpots = Math.floor(random() * 3) + 1;
        for (let i = 0; i < numSpots; i++) {
          const x = random() * 100; const y = random() * 100;
          const size = random() * 30 + 20; const opacity = random() * 0.1 + 0.05;
          backgroundGradients.push(`radial-gradient(circle at ${x}% ${y}%, rgba(210, 180, 140, ${opacity}) 0%, transparent ${size}%)`);
        }
      }
      if (random() < 0.35) {
        const numSmudges = Math.floor(random() * 4) + 1;
        for (let i = 0; i < numSmudges; i++) {
          const x = random() * 100; const y = random() * 100;
          const sizeX = random() * 20 + 5; const sizeY = random() * 20 + 5;
          const opacity = random() * 0.05 + 0.02;
          backgroundGradients.push(`radial-gradient(ellipse ${sizeX}% ${sizeY}% at ${x}% ${y}%, rgba(0, 0, 0, ${opacity}) 0%, transparent 70%)`);
        }
      }
      if (random() < 0.25) {
        const x = random() * 100; const y = random() * 100;
        const sizeX = random() * 40 + 20; const sizeY = random() * 40 + 20;
        backgroundGradients.push(`radial-gradient(ellipse ${sizeX}% ${sizeY}% at ${x}% ${y}%, rgba(101, 87, 62, 0.15) 0%, rgba(101, 87, 62, 0.1) 40%, rgba(85, 69, 43, 0.25) 90%, transparent 100%)`);
      }
      if (random() < 0.18) {
        const patchX = random() * 80 + 10; const patchY = random() * 80 + 10;
        const patchSize = random() * 15 + 5; const numSpecks = Math.floor(random() * 50) + 30;
        for (let i = 0; i < numSpecks; i++) {
          const speckX = patchX + (random() - 0.5) * patchSize; const speckY = patchY + (random() - 0.5) * patchSize;
          const speckSize = (random() * 0.4 + 0.1).toFixed(2); const opacity = random() * 0.3 + 0.2;
          backgroundGradients.push(`radial-gradient(circle at ${speckX}% ${speckY}%, rgba(40, 50, 40, ${opacity}) 0%, transparent ${speckSize}%)`);
        }
      }
      if (backgroundGradients.length > 0) {paperElement.style.backgroundImage = backgroundGradients.join(', ');}
      if (random() < 0.25) {
        const numScuffs = Math.floor(random() * 3) + 1;
        for (let i = 0; i < numScuffs; i++) {
          const scuff = document.createElement('div');
          scuff.style.position = 'absolute'; scuff.style.top = `${random() * 80 + 10}%`; scuff.style.left = `${random() * 80 + 10}%`;
          scuff.style.width = `${random() * 30 + 10}%`; scuff.style.height = `${random() * 10 + 2}%`;
          scuff.style.backgroundColor = `rgba(0,0,0,${random() * 0.03 + 0.01})`; scuff.style.transform = `rotate(${(random() - 0.5) * 45}deg)`;
          scuff.style.maskImage = `url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E")`;
          scuff.style.zIndex = '1'; paperElement.appendChild(scuff);
        }
      }
      if (random() < 0.25) {
        const numHoles = Math.floor(random() * 20) + 1;
        for (let i = 0; i < numHoles; i++) {
          const hole = document.createElement('div');
          hole.style.position = 'absolute'; hole.style.top = `${random() * 90 + 5}%`; hole.style.left = `${random() * 90 + 5}%`;
          const size = random() * 0.8 + 0.2; hole.style.width = `${size}cqw`; hole.style.height = `${size}cqw`;
          hole.style.backgroundColor = 'rgba(44, 44, 44, 0.8)'; hole.style.borderRadius = '50%';
          hole.style.boxShadow = 'inset 1px 1px 2px rgba(0,0,0,0.5), 0 0 1px 1px rgba(241, 233, 210, 0.5)';
          hole.style.zIndex = '3'; paperElement.appendChild(hole);
        }
      }
      if (random() < 0.3) {
        const angle = random() * 180 - 90; const position = random() * 100; const opacity = random() * 0.1 + 0.05;
        addDynamicStyles(`.paper::before { background: linear-gradient(${angle}deg, rgba(0,0,0,${opacity}) ${position - 1}%, rgba(0,0,0,${opacity * 1.5}) ${position}%, rgba(255,255,255,${opacity}) ${position + 1}%, rgba(255,255,255,0) ${position + 3}%); }`);
      }
      if (random() < 0.15) {
        const corner = Math.floor(random() * 4); const size = random() * 10 + 10;
        let cornerStyles = `width: ${size}cqw; height: ${size}cqw; background: linear-gradient(135deg, #f8f2e2, #e0d8c3); filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.4));`;
        switch (corner) {
          case 0: cornerStyles += `top: -1cqw; left: -1cqw; transform: rotate(-${random() * 10}deg); border-radius: 0 0 100% 0;`; break;
          case 1: cornerStyles += `top: -1cqw; right: -1cqw; left: auto; transform: rotate(${random() * 10}deg); border-radius: 0 0 0 100%;`; break;
          case 2: cornerStyles += `bottom: -1cqw; top: auto; left: -1cqw; transform: rotate(${random() * 10}deg); border-radius: 0 100% 0 0;`; break;
          case 3: cornerStyles += `bottom: -1cqw; top: auto; right: -1cqw; left: auto; transform: rotate(-${random() * 10}deg); border-radius: 100% 0 0 0;`; break;
        }
        addDynamicStyles(`.paper::after { ${cornerStyles} }`);
      }
      if (random() < 0.2) {
        const edge = Math.floor(random() * 4); let points = ['0% 0%', '100% 0%', '100% 100%', '0% 100%'];
        const tearDepth = random() * 4 + 3; const tearPoints = [];
        for (let i = 0; i < 10; i++) {
          const progress = (i + 1) / 11; const jaggedness = (random() - 0.5) * tearDepth;
          if (edge === 0) tearPoints.push(`${progress * 100}% ${tearDepth + jaggedness}%`);
          if (edge === 1) tearPoints.push(`${100 - tearDepth - jaggedness}% ${progress * 100}%`);
          if (edge === 2) tearPoints.push(`${progress * 100}% ${100 - tearDepth - jaggedness}%`);
          if (edge === 3) tearPoints.push(`${tearDepth + jaggedness}% ${progress * 100}%`);
        }
        if (edge === 0) points.splice(1, 0, ...tearPoints.reverse()); if (edge === 1) points.splice(2, 0, ...tearPoints);
        if (edge === 2) points.splice(3, 0, ...tearPoints); if (edge === 3) points.splice(4, 0, ...tearPoints.reverse());
        paperElement.style.clipPath = `polygon(${points.join(', ')})`;
      }

      const textToRender = `Dearest Reader,\n\nThe hour is late, and the world outside is hushed, save for the gentle patter of rain against the windowpane. In the soft glow of a single lamp, these keys clatter and sing, each one a small hammer striking a note in the quiet symphony of the night.\n\nThere is a certain magic in this old machine. It does not glide silently like the modern contraptions of glass and light. No, it demands effort. It speaks with a voice of ink and steel, a voice that remembers stories from a time long past.\n\nAnd so, I write to you, a message from another era, carried on the ghost of a ribbon.\n\nYours,\nA Humble Scribe`;
      const textContainer = document.getElementById('text-container');
      textContainer.innerHTML = '';
      const hitClasses = ['hit-light', 'hit-medium', 'hit-hard']; const alignClasses = ['align-up', 'align-down', ''];
      for (const char of textToRender) {
        if (char === '\n') {textContainer.appendChild(document.createElement('br'));}
        else if (char === ' ') {textContainer.appendChild(document.createTextNode(' '));}
        else {
          const span = document.createElement('span'); span.className = 'char'; span.textContent = char;
          const randomHit = hitClasses[Math.floor(random() * hitClasses.length)]; span.classList.add(randomHit);
          if (random() < 0.1) {
            const randomAlign = alignClasses[Math.floor(random() * alignClasses.length)];
            if (randomAlign) {span.classList.add(randomAlign);}
          }
          textContainer.appendChild(span);
        }
      }

      if (window.matchMedia('(hover: hover) and (pointer: fine)').matches) {
        const startZoom = (e) => {if (!paperElement.classList.contains('jumpscare-zoom')) {e.preventDefault(); paperElement.classList.add('zoomed');} };
        const endZoom = () => {paperElement.classList.remove('zoomed');};
        paperElement.addEventListener('mousedown', startZoom);
        paperElement.addEventListener('mouseup', endZoom);
        paperElement.addEventListener('mouseleave', endZoom);
      }

      document.getElementById('trigger-button').addEventListener('click', triggerJumpScare);

      function addDynamicStyles(css) {
        const style = document.createElement('style');
        style.textContent = css;
        document.head.appendChild(style);
      }
    });
  </script>

</body>

</html>
